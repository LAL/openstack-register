{% extends "base.html" %}
{% load i18n %}
{% block title %}OpenStack - Register{% endblock %}

{% block javascript %}
$(document).on("keyup click ready", function() {
    check_empty_fields();
    hide_send_button();
});

$( function() {
    hide_see_password();

    $('#checkButton').click( function() {
        if (( $("#usernameInput").val().length < 3 ) || ( $("#usernameInput").val().length > 20 )) {
            document.getElementById("errorText").innerHTML = "Username have to contains 3 to 20 characters !";
        }
        else {
            if ( isValidEmailAddress($("#emailInput").val()) == 0 ) {
                document.getElementById("errorText").innerHTML = "Email is not valid !";
            }
            else {
                if ( $("#firstnameInput").val() == '' ) {
                    document.getElementById("errorText").innerHTML = "Firstname can't be empty !";
                }
                else {
                    if ( $("#lastnameInput").val() == '' ) {
                        document.getElementById("errorText").innerHTML = "Lastname can't be empty !";
                    }
                    else {
                        if (( $("#passwordInput").val().length < 8 ) || ( $("#checkPasswordInput").val().length < 8)) {
                            document.getElementById("errorText").innerHTML = "Password have to contains at least 8 characters !";
                        }
                        else {
                            check_similar_password();
                            if ( document.getElementById("errorText").innerHTML == "" ) {
                                $("#sendButton").attr('type', 'button');
                            }
                        }
                    }
                }
            }
        }
    });
});

function hide_send_button() {
    if ( document.getElementById("errorText").innerHTML != "") {
        $("#sendButton").attr('type', 'hidden');
    }
    if ( $("input[style='border-color:red;'").length > 0 ) {
        $("#sendButton").attr('type', 'hidden');
    }
}

function check_similar_password() {
    if ( $("#passwordInput").val() != $("#checkPasswordInput").val() ) {
        document.getElementById("errorText").innerHTML = "Password aren't matching !";
    }
    else {
        document.getElementById("errorText").innerHTML = "";
    }
}

function hide_see_password() {
    $('#passwordIcon').click( function() {
        if ( $("#passwordInput").attr('type') == 'password') {
            $("#passwordInput").attr('type', 'text');
            $('#passwordIcon').attr('title', 'Hide Password');
            $('#passwordIcon').attr('class', 'btn btn-primary input-group-addon glyphicon glyphicon-eye-close');
        }
        else {
            $("#passwordInput").attr('type', 'password');
            $('#passwordIcon').attr('title', 'See Password');
            $('#passwordIcon').attr('class', 'btn btn-primary input-group-addon glyphicon glyphicon-eye-open');
        }
    });

    $('#checkPasswordIcon').click( function() {
        if ( $("#checkPasswordInput").attr('type') == 'password') {
            $("#checkPasswordInput").attr('type', 'text');
            $('#checkPasswordIcon').attr('title', 'Hide Password');
            $('#checkPasswordIcon').attr('class', 'btn btn-primary input-group-addon glyphicon glyphicon-eye-close');
        }
        else {
            $("#checkPasswordInput").attr('type', 'password');
            $('#checkPasswordIcon').attr('title', 'See Password');
            $('#checkPasswordIcon').attr('class', 'btn btn-primary input-group-addon glyphicon glyphicon-eye-open');
        }
    });
}

function check_empty_fields() {
    if ( $("#usernameInput").val() != '') {
        $("#usernameInput").attr('style', 'border-color:black;')
    }
    else {
        $("#usernameInput").attr('style', 'border-color:red;')
    }

    if ( $("#emailInput").val() != '') {
        $("#emailInput").attr('style', 'border-color:black;')
    }
    else {
        $("#emailInput").attr('style', 'border-color:red;')
    }

    if ( $("#firstnameInput").val() != '') {
        $("#firstnameInput").attr('style', 'border-color:black;')
    }
    else {
        $("#firstnameInput").attr('style', 'border-color:red;')
    }

    if ( $("#lastnameInput").val() != '') {
        $("#lastnameInput").attr('style', 'border-color:black;')
    }
    else {
        $("#lastnameInput").attr('style', 'border-color:red;')
    }

    if ( $("#passwordInput").val() != '') {
        $("#passwordInput").attr('style', 'border-color:black;')
    }
    else {
        $("#passwordInput").attr('style', 'border-color:red;')
    }

    if ( $("#checkPasswordInput").val() != '') {
        $("#checkPasswordInput").attr('style', 'border-color:black;')
    }
    else {
        $("#checkPasswordInput").attr('style', 'border-color:red;')
    }
}

function isValidEmailAddress(emailAddress) {
    var pattern = /^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i;
    return pattern.test(emailAddress);
}

{% endblock %}

{% block content %}
<div>
    <h2>Registration form</h2>

    <p>
      Please complete the following form to create a new account
      on the LAL cloud infrastructures.
    </p>
    <p>
      <strong>Fields in red are mandatory.</strong>
    </p>

    <!--<form id="form" action="register" enctype="application/x-www-form-urlencoded" method="POST">{% csrf_token %}-->
    <form id="form">
        <div class="form-group col-sm-10">
            <label id="usernameLabel" class="control-label col-sm-2">Username: </label>
            <div id="username" class="col-sm-3">
                <input style="border-color:red;" id="usernameInput" type="text" value="" class="form-control" placeholder="Username" aria-describedby="basic-addon1">
            </div>
            <div class="col-sm-5"></div>
        </div>
        <div class="form-group col-sm-10">
            <label id="emailLabel" class="control-label col-sm-2">Email address: </label>
            <div id="email" class="col-sm-3">
                <input style="border-color:red;" id="emailInput" type="text" value="" class="form-control" placeholder="Email address" aria-describedby="basic-addon1">
            </div>
            <div class="col-sm-5"></div>
        </div>
        <div class="form-group col-sm-10">
            <label id="firstnameLabel" class="control-label col-sm-2">Firstname: </label>
            <div id="firstname" class="col-sm-3">
                <input style="border-color:red;" id="firstnameInput" type="text" value="" class="form-control" placeholder="Firstname" aria-describedby="basic-addon1">
            </div>
            <div class="col-sm-5"></div>
        </div>
        <div class="form-group col-sm-10">
            <label id="lastnameLabel" class="control-label col-sm-2">Lastname: </label>
            <div id="lastname" class="col-sm-3">
                <input style="border-color:red;" id="lastnameInput" type="text" value="" class="form-control" placeholder="Lastname" aria-describedby="basic-addon1">
            </div>
            <div class="col-sm-5"></div>
        </div>
        <div class="form-group col-sm-10">
            <label id="passwordLabel" class="control-label col-sm-2">Password: </label>
            <div id="password" class="col-sm-3">
                <div class="input-group">
                    <input style="border-color:red;" id="passwordInput" type="password" value="" class="form-control" placeholder="Password" aria-describedby="basic-addon1">
                    <span id="passwordIcon" title="See password" class="btn btn-primary input-group-addon glyphicon glyphicon-eye-open"></span>
                </div>
            </div>
            <div class="col-sm-5"></div>
        </div>
        <div class="form-group col-sm-10">
            <label id="checkPasswordLabel" class="control-label col-sm-2">Retype password: </label>
            <div id="checkPassword" class="col-sm-3">
                <div class="input-group">
                    <input style="border-color:red;" id="checkPasswordInput" type="password" value="" class="form-control" placeholder="Retype your password" aria-describedby="basic-addon1">
                    <span id="checkPasswordIcon" title="See password" class="btn btn-primary input-group-addon glyphicon glyphicon-eye-open"></span>
                </div>
            </div>
            <div class="col-sm-5"></div>
        </div>
        <div class="form-group col-sm-10">
            <label id="messageLabel" class="control-label col-sm-2">Message: </label>
            <div id="message" class="col-sm-3">
                <textarea cols="40" rows="5"></textarea>
            </div>
            <div class="col-sm-5"></div>
        </div>
        <div class="form-group col-sm-10">
            <label id="agreementLabel" class="control-label col-sm-5">I agree to the defined <a href="/policies" target="_blank">terms, conditions, and policies</a></label>
            <div id="agreement" class="col-sm-1">
                <input type="checkbox" name="agreement">
            </div>
            <div class="col-sm-5"></div>
        </div>
        <div class="col-sm-10">
            <!--<p><i>* 3 to 20 characters characters</i></p>-->
            <!--<p><i>** At least 8 characters</i></p>-->
            <p id="errorText" style="color:red"></p>
            <div class="col-sm-5"></div>
        </div>
        <div class="col-sm-10">
            <input class="btn btn-primary col-sm-2" id="checkButton" value="Check Form" type="button">
            <div class="col-sm-3"></div>
            <input class="btn btn-primary col-sm-1" type="hidden" id="sendButton" value="Send">
        </div>
    </form>
</div>
{% endblock %}